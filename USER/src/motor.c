

/***********************************************************************************************************************
 * INCLUDES
 */
#include "stm32f4xx.h"
#include "timer.h"
#include "Motor.h"
#include "delay.h"

/***********************************************************************************************************************
 * CONSTANTS
 */


/***********************************************************************************************************************
 * TYPEDEFS
 */


/***********************************************************************************************************************
 * LOCAL VARIABLES
 */
 
/***********************************************************************************************************************
 * LOCAL FUNCTIONS  DECLARE
 */


/***********************************************************************************************************************
 * LOCAL FUNCTIONS  
 */



/***********************************************************************************************************************
 * PUBLIC FUNCTIONS
 */
/**********************************************************************************************************
 * 函数名：        Motor_init
 * 功能描述：      马达初始化，主要是初始化PWM通道
   
 * 参数说明：  
 * 返回值说明：
 * 修改记录：
**********************************************************************************************************/
void Motor_init(void)
{
  TIM2_initPWM(500-1,50-1);	//1Mhz的计数频率,2Khz的PWM.  
}
/**********************************************************************************************************
 * 函数名：        Motor_ON
 * 功能描述：      打开马达，马达以设定的震动强度和震动次数震动
   
 * 参数说明：      intensity:震动强度，实际上是改变PWM波有效电平的宽度，提高有效电平的占空比，
 *                           以达到改变马达震动的目的
 *                 times:震动次数
 * 返回值说明：
 * 修改记录：
**********************************************************************************************************/
void Motor_ON(u16 intensity,u8 times)
{
  u8 i;
  u16 tempIntensity = intensity;      //保存震动强度
  for(i=0;i<times;i++)
  {
    MOTOR_PWM_VAL = tempIntensity;    //设置震动强度
   TIM2_enablePWM();               //使能TIM14_PWM
    delay_ms(400);       
    
    MOTOR_PWM_VAL = MOROT_INTENSITY_0;//设置震动强度
    TIM2_disablePWM();		          //禁止TIM14_PWM
    delay_ms(400);
  }
  
}

/***********************************************************************************************************************
***********************************************************************************************************************/
